#pragma once

#include <memory>
#include <vector>

#include "aho_corasick.hpp"
#include "ilogger.h"

namespace samlw {
class MainHandler {
   public:
    MainHandler(std::shared_ptr<ILogger> logger = nullptr) : logger_(logger){};
    ~MainHandler() = default;

    void OpenClient(DWORD session_id) const noexcept;
    void OpenClient() const noexcept;
    void CreateNamedPipeServer();
    void ScanFile(const wchar_t* file_path);
    void LoadDatabase() noexcept;

   protected:
    std::shared_ptr<ILogger> logger_;
    aho_corasick::trie* ac_;
};
}  // namespace samlw